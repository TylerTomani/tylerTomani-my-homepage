<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>01_GetStartGmailApi-Python</title>
    <link rel="stylesheet" href="../../../../../../../../../css/resource-header-temp.css" />
    <link rel="stylesheet" href="../../../../../../../../../css/tutorial-temp-v2.css" />
    <link rel="stylesheet" href="../../../../../../../../../../css/copy-code.css">
    <link rel="stylesheet" href="../../../../../../../../../../css/imgAnimate-v2.css">
    <script src="../../../../../../../../../js/letterFocus-tutorial.js" defer></script>
    <script src="../../../../../../../../../../js/copy-code.js" defer></script>
    <script src="../../../../../../../../../js/dropPartStepFocus-v2.js" defer></script>
    <script type="module" src="../../../../../../../../../js/img-enlarge-v1.js" defer></script>
    <script type="module" src="../../../../../../../../../js/addRemoveTabs-v1.js" defer></script>
</head>
<body>
    <header>
        <div class="home-link">
            <a id="homeLink" tabindex="1" href="../../jie-jenn-gmail.htm">(home)gmail-api-jieJenn</a>
        </div>
        <div class="title-container">
            <h1>Jie Jenn - gmail api</h1>
            <h2>01_Getting Started with Gmail API in Python (For Beginners)</h2>
        </div>
        <div class="img-container">
            <img src="../00-googleDriveApiPython.png">
            <a id="tutorialLink" tabindex="1" target="_blank" href="https://www.youtube.com/watch?v=7X3fBlMw_1k">tutorial</a>
        </div>
    </header>
    <main>
        <div class="parts-container">
            <!-- Part 1 - Create venv & install flask  -->
            <div class="part">
                <a id="part01" tabindex="1" href="#" class="dropPart"><h3>Part 1 - Api Docs and scopes </h3></a>
                <div class="steps-container">
                    <!-- 01-01 -->
                    <div class="step">
                        <div tabindex="1" class="step-txt">
                            <h3>01</h3>
                            <p>
                                &emsp;Go to the Gmail api homepage, and click on <q>Guides</q>
                                <br>
                                <a tabindex="-1" target="_blank" href="https://developers.google.com/gmail/api/guides">https://developers.google.com/gmail/api/guides</a>
                            </p>
                            <p>
                                &emsp;Here, the methods, classes, and use cases are described
                            </p>
                        </div>
                        <div class="step-img">
                            <img class="sm-enlarge" src="imagesVideos/01-01.png">
                        </div>
                    </div>
                    <!-- 01-02 -->
                    <div class="step">
                        <div tabindex="1" class="step-txt ">
                            <h3>02</h3>
                            <h4>Scopes</h4>
                            <p>
                                &emsp;Go to, 
                                <br>
                                <i><q>Authentification & authorization</q></i> &rarr; <i><q>Choose scopes</q></i>
                                <br>
                                <a tabindex="-1" target="_blank" href="https://developers.google.com/gmail/api/auth/scopes">https://developers.google.com/gmail/api/auth/scopes</a>
                            </p>
                        </div>
                        <div class="step-img ">
                            <img class="lg-enlarge" src="imagesVideos/01-02.png">
                        </div>
                    </div>
                    <!-- 01-03 -->
                    <div class="step">
                        <div tabindex="1" class="step-txt">
                            <h3>03</h3>
                            <p>
                                Common scopes are,
                            </p>
                            <div class="code-container md-code">
                                <pre tabindex="1" class="smmd-code copy-code ">
https://www.googleapis.com/auth/gmail.labels</pre>
                            </div>
                            <p>
                                and,
                            </p>
                            <div class="code-container ">
                                <pre tabindex="1" class="smmd-code copy-code">
https://www.googleapis.com/auth/gmail.settings.basic</pre>
                            </div>
                        </div>
                        <div class="step-img">
                            <img class="lg-enlarge" src="imagesVideos/01-03.png">
                        </div>
                    </div>
                    <!-- 01-04 -->
                    <div class="step">
                        <div tabindex="1" class="step-txt">
                            <h3>04</h3>
                            <div class="code-container ">
                                <pre tabindex="1" class="copy-code md-code">
https://mail.google.com/</pre>
                            </div>
                            <p>
                                Gives you full permission to gmail
                            </p>
                        </div>
                        <div class="step-img ">
                            <img class="" src="imagesVideos/01-04.png">
                        </div>
                    </div>
                </div>
            </div>
            <!-- Part 2 - Documentation Python for Gmail API  -->
            <div class="part">
                <a id="" tabindex="1" href="#" class="dropPart"><h3>Part 2 - Documentation Python for Gmail API </h3></a>
                <div class="steps-container ">
                    <!-- 02-01 -->
                    <div class="step">
                        <div tabindex="1" class="step-txt">
                            <h3>01</h3>
                            <p>
                                Go to <i><q>Guides</q></i> &rarr;Gmail API &rarr;Quickstarts &rarr; Python
                                then,
                                <br>
                                <a target="_blank"
                                    href="https://developers.google.com/gmail/api/quickstart/python">https://developers.google.com/gmail/api/quickstart/python</a>
                            </p>
                        </div>
                        <div class="step-img">
                            <img class="animate-lg" src="imagesVideos/02-01.png">
                        </div>
                    </div>
                    <!-- 02-02 -->
                    <div class="step">
                        <div tabindex="1" class="step-txt">
                            <h3>02</h3>
                            <h4>Instructions for setup and install</h4>
                            <p>
                                You can follow the instructions on this page to see up, or continue to <a id="part03Link" >Part 3 - Create Project</a>
                            </p>
                        </div>
                        <div class="step-img">
                            <img src="imagesVideos/02-02.png">
                        </div>
                    </div>
                </div>
            </div>
        <!-- Part 3 - google cloud platform - Create Project -->
            <div class="part">
                <a id="" tabindex="1" href="#" class="dropPart"><h3>Part 3 - google cloud platform - Create Project</h3></a>
                <h3>console.cloud.google</h3>
                <div class="steps-container ">
                    <!-- 03-01 -->
                    <div class="step">
                        <div tabindex="1" class="step-txt">
                            <h3>01</h3>
                            <p>
                                Go to google cloud platform,
                                <br>
                                <a target="_blank" href="https://console.cloud.google.com/welcome?authuser=0&organizationId=0
                                ">https://console.cloud.google.com/welcome?authuser=0&organizationId=0</a>
                            </p>
                        </div>
                        <div class="step-img">
                            <img class="animate-xlg" src="imagesVideos/03-01.png">
                        </div>
                    </div>
                    <!-- 03-02 -->
                    <div class="step">
                        <div tabindex="1" class="step-txt">
                            <h4>02</h4>
                            <p>
                                Click the Project drop menu and then click <i><q>NEW PROJECT</q></i>
                            </p>
                        </div>
                        <div class="step-img">
                            <img class="animate-xlg" src="imagesVideos/03-02.png">
                        </div>
                    </div>
                    <!-- 03-03 -->
                    <div class="step">
                        <div tabindex="1" class="step-txt">
                            <h4>03</h4>
                            <p>
                                Name and <i><q>Create</q></i>
                            </p>
                        </div>
                        <div class="step-img">
                            <img class="animate-xlg" src="imagesVideos/03-03.png">
                        </div>
                    </div>
                </div>
            </div>
        <!-- Part 4 Manage Gmail API - API Library  -->
            <div class="part">
                <h3><a tabindex="1" href="#" class="dropPart">Part 4 Manage Gmail API - API Library</a></h3>
                <div class="steps-container">
                    <!-- 04-01 -->
                    <div class="step">
                        <div tabindex="1" class="step-txt">
                            <h4>01</h4>
                            <p>
                                In the project, go to <i><q>APIs & Services</q></i> &rarr; Library
                                <br>
                                <a target="_blank" href="https://console.cloud.google.com/apis/library?authuser=0&project=gmail-api-jiejenn-408314
                                ">https://console.cloud.google.com/apis/library?authuser=0&project=gmail-api-jiejenn-</a>
                            </p>
                        </div>
                        <div class="step-img">
                            <img class="animate-xlg" src="imagesVideos/04-01.png">
                        </div>
                    </div>
                    <!-- 04-02 -->
                    <div class="step">
                        <div tabindex="1" class="step-txt">
                            <h4>02</h4>
                            <p>
                                Search for <q>Gmail Api</q>
                            </p>
                        </div>
                        <div class="step-img">
                            <img class="animate-xlg" src="imagesVideos/04-02.png">
                        </div>
                    </div>
                    <!-- 04-03 -->
                    <div class="step">
                        <div tabindex="1" class="step-txt">
                            <h4>03</h4>
                            <p>
                                Click <q>Gmail Api</q>
                            </p>
                        </div>
                        <div class="step-img">
                            <img class="animate-xlg" src="imagesVideos/04-03.png">
                        </div>
                    </div>
                    <!-- 04-04 -->
                    <div class="step">
                        <div tabindex="1" class="step-txt">
                            <h4>04</h4>
                            <p>
                                Click <i><q>Enable</q></i> or <i><q>MANAGE</q></i>
                            </p>
                        </div>
                        <div class="step-img">
                            <img class="animate-xlg" src="imagesVideos/04-04.png">
                        </div>
                    </div>
                </div>
            </div>
        <!-- Part 5 - Credentials - Api key & Oauth Client_Secret -->
            <div class="part">
                <h3><a tabindex="1" href="#">Part 5 - Credentials - Api key & Oauth Client_Secret</a></h3>
                <div class="steps-container ">
                    <!-- 05-01 -->
                    <div class="step">
                        <div tabindex="1" class="step-txt">
                            <h4>01</h4>
                            <p>
                                Go to <i><q>Credentials</q></i> page
                                <br>
                                <a target="_blank" href="https://console.cloud.google.com/apis/credentials?authuser=0&project=gmail-api-jiejenn-408314
                                ">https://console.cloud.google.com/apis/credentials?authuser=0&project=gmail-api-jiejenn-408314</a>
                            </p>
                        </div>
                        <div class="step-img">
                            <img class="animate-xlg" src="imagesVideos/05-01.png">
                        </div>
                    </div>
                    <!-- 05-02 -->
                    <div class="step">
                        <div tabindex="1" class="step-txt">
                            <h4>02</h4>
                            <p>
                                <span style="color:red">Review Varisty tutors Page</span>
                                <a target="_blank" href="../../../../../my-windows-homepage/varsity-tutors-sessions/session1/session1.htm">
                                    Vasirty Tutors Session 1
                                </a>
                            </p>
                            <p>
                                Click <i><q>CREATE CREDENTIALS</q></i>
                            </p>
                        </div>
                        <div class="step-img">
                            <img class="" src="imagesVideos/05-02.png">
                        </div>
                    </div>
                    <!-- 05-03 -->
                    <div class="step">
                        <div tabindex="1" class="step-txt">
                            <h4>03</h4>
                            <p>
                                Click, 
                                <br>
                                <i><q>CONFIGURE CONSEN SCREEN</q></i>
                            </p>
                        </div>
                        <div class="step-img">
                            <img class="" src="imagesVideos/05-03.png">
                        </div>
                    </div>
                    <!-- 05-04 -->
                    <div class="step">
                        <div tabindex="1" class="step-txt">
                            <h4>04</h4>
                            <p>
                                Choose <i><q>External</q></i>
                                <br>
                                <span class="r">Check to see if you need to use "Internal"</span>
                                <a target="_blank" href="../../codeTops/00-howGetStartGmailAPI/00-howGetStartGmailAPI.htm">codetops_00-getstarted</a> 
                            </p>
                        </div>
                        <div class="step-img">
                            <img class="animate-lg" src="imagesVideos/05-04.png">
                        </div>
                    </div>
                    <!-- 05-05 -->
                    <div class="step">
                        <div tabindex="1" class="step-txt playVid-click">
                            <h4>05</h4>
                            <p>
                                Name and enter an email, 
                            </p>
                        </div>
                        <div class="step-vid">
                            <video  src="imagesVideos/05-05.mov">
                        </div>
                    </div>
                    <!-- 05-06 -->
                    <div class="step">
                        <div tabindex="1" class="step-txt">
                            <h4>06</h4>
                            <p>
                                Enter the full permission scope
                            </p>
                            <div class="code-container asc">
                                <pre tabindex="1" class="copy-code">
https://mail.google.com/</pre>
                            </div>
                            
                        </div>
                        <div class="step-img">
                            <img src="imagesVideos/05-06.png">
                        </div>
                    </div>
                    <!-- 05-07 -->
                    <div class="step">
                        <div tabindex="1" class="step-txt">
                            <h4>07</h4>
                            <p>
                                Click <i><q>SAVE AND CONTINUE</q></i>
                            </p>
                        </div>
                        <div class="step-img">
                            <img src="imagesVideos/05-07.png">
                        </div>
                    </div>
                    <!-- 05-08 -->
                    <div class="step">
                        <div tabindex="1" class="step-txt">
                            <h4>08</h4>
                            <p>
                                Add your email as a <i>Test User</i>
                                and then hit <i><q>SAVE AND CONTINUE</q></i>
                            </p>
                        </div>
                        <div class="step-img">
                            <img src="imagesVideos/">
                        </div>
                    </div>
                </div>
            </div>
        <!-- Part 6 - Create OAuth Client Id - Client_Secret -->
            <div class="part">
                <h3><a tabindex="1" href="#">Part 6 - Create OAuth Client Id - Client_Secret</a></h3>
                <div class="steps-container">
                    <!-- 06-01 -->
                    <div class="step">
                        <div tabindex="1" class="step-txt">
                            <h4>01</h4>
                            <p>
                                Go to <i>Credentials</i>
                                then, <i>OAuth Client Id</i>
                            </p>
                        </div>
                        <div class="step-img">
                            <img src="imagesVideos/06-01.png">
                        </div>
                    </div>
                    <!-- 06-02 -->
                    <div class="step">
                        <div tabindex="1" class="step-txt">
                            <h4>02</h4>
                            <p>
                                Download the json file to the same directory as the project
                            </p>
                        </div>
                        <div class="step-img">
                            <img src="imagesVideos/06-02.png">
                        </div>
                    </div>
                </div>                
            </div>
        <!-- Part 7 Create a VENV & Install Libraries -->
            <div class="part">
                <h3><a tabindex="1" href="#">Part 7 Create a VENV & Install Libraries</a></h3>
                <div class="steps-container ">
                    <!-- 07-01 -->
                    <div class="step">
                        <div tabindex="1" class="step-txt">
                            <h4>01</h4>
                            <p>
                                Go to 
                                <a target="_blank" href="../../../../../my-windows-homepage/resources/flask/coreyshafer/01-flask/01-flask.htm
                                ">Corey Schafer 01-flask</a> for review, and install a venv in the directory of the project, and install the libraries
                            </p>
                            <div class="code-container asc vs-console">
                                <pre tabindex="1" class="copy-code">
python -m venv venv</pre>
                            </div>
                            <div class="code-container asc vs-console">
                                <pre tabindex="1" class="copy-code">
./venv/bin/activate</pre>
                            </div>
                            
                        </div>
                        <div class="step-img">
                            <img src="imagesVideos/07-01.png">
                        </div>
                    </div>
                    <!-- 07-02 -->
                    <div class="step">
                        <div tabindex="1" class="step-txt">
                            <h4>02</h4>
                            <p>
                                If <code>./venv/bin/activate</code> <strong>Does Not Work</strong>
                                run 
                            </p>
                            <div class="code-container vs-console ac">
                                <pre tabindex="1" class="copy-code">
source ./venv/bin/activate</pre>
                            </div>
                            
                        </div>
                        <div class="step-img">
                            <img src="imagesVideos/07-02.png">
                        </div>
                    </div>
                    <!-- 07-03 -->
                    <div class="step">
                        <div tabindex="1" class="step-txt">
                            <h4>03</h4>
                            <p>
                                Go to <a target="_blank" href="https://developers.google.com/gmail/api/quickstart/python">
                                    https://developers.google.com/gmail/api/quickstart/python
                                </a>,
                                and install the client libraries
                            </p>
                            <div class="code-container asc">
                                <pre tabindex="1" class="copy-code">
pip install --upgrade google-api-python-client google-auth-httplib2 google-auth-oauthlib</pre>
                            </div>
                            
                        </div>
                        <div class="step-img">
                            <img src="imagesVideos/07-03.png">
                        </div>
                    </div>
                </div>
            </div>
            <!-- Part 8 Python Script -->
            <div class="part">
                <h3><a tabindex="1" href="#">Part 8 Python Script</a></h3>
                <div class="steps-container">
                    <!-- 08-01 -->
                    <div class="step">
                        <div tabindex="1" class="step-txt">
                            <h4>01</h4>
                            <p>
                                Go to <a target="_blank" href="https://learndataanalysis.org/google-py-file-source-code/">
                                    https://learndataanalysis.org/google-py-file-source-code/
                                </a>
                                and make sure you install,
                            </p>
                            <div class="code-container asc">
                                <pre tabindex="1" class="copy-code">
pip install –upgrade google-api-python-client google-auth-httplib2 google-auth-oauthlib</pre>
                            </div>
                            
                            <p>Into your venv</p>
                        </div>
                        <div class="step-img">
                            <img src="imagesVideos/08-01.png">
                        </div>
                    </div>
                    <!-- 08-02 -->
                    <div class="step">
                        <div tabindex="1" class="step-txt">
                            <h4>02</h4>
                            <p>
                                <span style="text-decoration: line-through;" class="">Here is a basic script using the <code>Create_Service</code>
                                function from the <code>Google</code> api</span>
                                <span class="r">Don't use his script</span>
                                it doesnt work, Instead go to 
                                <br>
                                <a target="_blank" href="https://developers.google.com/gmail/api/quickstart/python#:~:text=In%20your%20working%20directory%2C%20create%20a%20file%20named%20quickstart.py.
                                ">https://developers.google.com/gmail/api/quickstart/python</a>
                                an copy the example code 
                            </p>
                        </div>
                        <div class="step-img">
                            <img src="imagesVideos/08-02.png">
                        </div>
                    </div>

                    <!-- 08-03 -->
                    <div class="step">
                        <div tabindex="1" class="step-txt">
                            <h4>03</h4>
                            <p>
                                do the following changes, the 
                            </p>
                            <div class="code-container asc">
                                <pre tabindex="1" class="copy-code md-code">
print(<span class="m">dir</span>(service))</pre>
                            </div>
                            <p>
                                Will print all the methods an classes in the api
                            </p>
                            <div class="code-container md-code">
                                <pre tabindex="1" class="copy-code">
import os.path
from google.auth.transport.requests import Request
from google.oauth2.credentials import Credentials
from google_auth_oauthlib.flow import InstalledAppFlow
from googleapiclient.discovery import build
from googleapiclient.errors import HttpError
SCOPES = ["https://www.googleapis.com/auth/gmail.readonly"]


def main():
    creds = None
    if os.path.exists("token.json"):
        creds = Credentials.from_authorized_user_file("token.json", SCOPES)
    if not creds or not creds.valid:
        if creds and creds.expired and creds.refresh_token:
            creds.refresh(Request())
        else:
            flow = InstalledAppFlow.from_client_secrets_file(
            "client_secret.json", SCOPES
        )
        creds = flow.run_local_server(port=0)
    with open("token.json", "w") as token:
        token.write(creds.to_json())
    try:
        service = build("gmail", "v1", credentials=creds)
        print(dir(service))
    except HttpError as error:
        print(f"An error occurred: {error}")

if __name__ == "__main__":
    main()
                                
                                </pre>
                            </div>
                            
                        </div>
                        <div class="step-img">
                            <img src="imagesVideos/08-03.png">
                        </div>
                    </div>
                    <!-- 08-04 -->
                    <div class="step">
                        <div tabindex="1" class="step-txt">
                            <h4>04</h4>
                            <p>
                                We can do the same and see the methods for <code>results</code>
                                which is <code>service.users().message().list(userId='me').execute()</code>
                            </p>
                            <div class="code-container asc">
                                <pre tabindex="1" class="copy-code">
import os.path
from google.auth.transport.requests import Request
from google.oauth2.credentials import Credentials
from google_auth_oauthlib.flow import InstalledAppFlow
from googleapiclient.discovery import build
from googleapiclient.errors import HttpError
SCOPES = ["https://www.googleapis.com/auth/gmail.readonly"]


def main():
    creds = None
    if os.path.exists("token.json"):
        creds = Credentials.from_authorized_user_file("token.json", SCOPES)
    if not creds or not creds.valid:
        if creds and creds.expired and creds.refresh_token:
            creds.refresh(Request())
        else:
            flow = InstalledAppFlow.from_client_secrets_file(
            "client_secret.json", SCOPES
        )
        creds = flow.run_local_server(port=0)
    with open("token.json", "w") as token:
        token.write(creds.to_json())
    try:
        service = build("gmail", "v1", credentials=creds)
        print(dir(service))
        results = service.users().messages().list(userId="me").execute()
        print(dir(results))
    except HttpError as error:
        print(f"An error occurred: {error}")

if __name__ == "__main__":
    main()
                                
                                </pre>
                            </div>
                            
                        </div>
                        <div class="step-img">
                            <img src="imagesVideos/08-04.png">
                        </div>
                    </div>
                    <!-- 08-05 -->
                    <div class="step">
                        <div tabindex="1" class="step-txt">
                            <h4>05</h4>
                            <p>
                                Use the 
                                <code class="lc">get()</code> function
                                you can see from <code>dir(results)</code> 
                                to get the <code><q>messages</q></code>
                                from <code>results</code>
                            </p>
                            <div class="code-container asc">
                                <pre tabindex="1" class="copy-code">
messages = results.get('messages',[])</pre>
                            </div>
                            <p>
                                You can see the ids for each message
                            </p>
                            
                        </div>
                        <div class="step-img">
                            <img src="imagesVideos/08-05.png">
                        </div>
                    </div>
                    <!-- 08-06 -->
                    <!-- <div class="step">
                        <div tabindex="1" class="step-txt">
                            <h4>03</h4>
                            <h5><code>users.getProfile</code></h5>
                            <p>
                                go to <a target="_blank" href="https://developers.google.com/gmail/api/reference/rest/v1/users/getProfile">
                                    https://developers.google.com/gmail/api/reference/rest/v1/users/getProfile
                                </a>
                                to see how to make request
                            </p>
                        </div>
                        <div class="step-img">
                             <img src="imagesVideos/08-03.png">
                        </div>
                    </div> -->
                </div>
                
            </div>
        </div>

    </main>

</body>
</html>